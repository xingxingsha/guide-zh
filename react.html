<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <!-- Basic -->
    <title>React | Meteor 指南 中译本</title>
    <meta name="description" content="如何在 Meteor 中使用 React（Facebook 的前端渲染库）">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="../images/favicon.png" sizes="16x16 32x32 64x64">

    <!-- Social -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="http://guide-zh.ourmeteor.com">
    <meta property="og:title" content="React | Meteor 指南 中译本">
    <meta property="og:description" content="如何在 Meteor 中使用 React（Facebook 的前端渲染库）">
    <meta property="og:image" content="">
    <meta name="twitter:card" content="summary_image_large">
    <meta name="twitter:site" content="@meteor">
    <meta name="twitter:title" content="React | Meteor 指南 中译本">
    <meta name="twitter:description" content="如何在 Meteor 中使用 React（Facebook 的前端渲染库）">
    <meta name="twitter:image" content="">

    <!-- Misc -->
    <meta name="google-site-verification" content="" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,200,300italic,400italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/style/style.css">
  </head>
  <body class="">
    

<div class="sidebar">
  <div class="panel">
    <div class="panel-item logo">
      <a href="http://www.meteor.com/developers" title="Meteor Developers" target=_new >
        <img src="../images/icon-white.svg" alt="Meteor Developers">
        <span>Meteor Developers</span>
      </a>
    </div>
    
      <div class="panel-item "">
        <a class="" href="http://www.meteor.com/tutorials" target=_new >
          <svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><g fill="#112B49"><circle cx="80.001" cy="80" r="3"/><path d="M75.73 85.723c.193-.183.316-.437.316-.723 0-.553-.447-1-1-1-.278 0-.528.114-.71.297l-.004-.004-50.9 50.875c-.18.18-.29.43-.29.707-.002.553.445 1 .998 1 .276 0 .526-.112.708-.293l50.883-50.86zM84.235 74.4c-.18.183-.292.433-.292.71 0 .552.446 1 1 1 .275 0 .525-.113.707-.294l50.87-50.89c.204-.184.34-.442.34-.74 0-.552-.448-1-1-1-.276 0-.526.113-.707.294l-.01-.01L84.236 74.4zM136.583 135.184L85.65 84.23c-.182-.18-.432-.293-.708-.293-.552 0-1 .447-1 1 0 .278.114.528.297.71l50.927 50.95c.18.18.43.293.708.293.553 0 1-.447 1-1 0-.276-.11-.525-.292-.706zM111.19 152.602l-.003-.005-.002-.004-27.552-66.507h-.002c-.15-.362-.505-.617-.922-.617-.552 0-1 .446-1 1 0 .135.028.263.077.38v.002l.005.012 27.552 66.504c.15.362.507.617.924.617.553 0 1-.447 1-1 0-.136-.03-.265-.077-.383zM48.873 7.384L76.435 73.93h.002c.15.362.505.617.922.617.552 0 1-.447 1-1 0-.136-.03-.264-.078-.382h.003L50.72 6.616c-.15-.362-.506-.617-.923-.617-.552 0-1 .447-1 1 0 .136.03.265.078.383h-.002zM152.55 48.844h-.002L86.092 76.422c-.36.15-.617.507-.617.924 0 .553.446 1 1 1 .135 0 .265-.028.383-.077L153.32 50.69c.363-.15.618-.507.618-.924 0-.553-.447-1-1-1-.136 0-.265.028-.383.077h-.005zM7.41 111.136h.002l66.492-27.54c.36-.15.616-.507.616-.924 0-.553-.447-1-1-1-.136 0-.264.028-.382.077v-.002l-.004.002c-.002 0-.004 0-.006.002L6.638 109.29c-.36.15-.615.507-.615.924 0 .553.446 1 1 1 .135 0 .264-.028.382-.077h.004zM159 79H87c-.552 0-1 .448-1 1 0 .554.447 1 1 1h72c.553 0 1-.447 1-1s-.447-1-1-1zM23.435 24.85l50.897 50.897.008-.008c.182.18.43.29.707.29.553 0 1-.446 1-1 0-.296-.135-.555-.34-.737L24.85 23.433c-.183-.18-.433-.292-.71-.292-.55 0-.998.448-.998 1 0 .277.11.528.293.71zM6.618 50.657v.002l66.51 27.54c.003 0 .005 0 .007.002l.004.002c.117.048.245.076.38.076.554 0 1-.447 1-1 0-.417-.254-.772-.616-.923v-.002L7.392 48.813H7.39l-.005-.003c-.118-.047-.247-.076-.383-.076-.552 0-1 .447-1 1 0 .417.256.773.618.923zM153.383 109.28l-66.52-27.53-.006-.002c-.118-.048-.248-.076-.384-.076-.552 0-1 .447-1 1 0 .417.256.773.62.923l66.513 27.528c.003 0 .005 0 .007.002l.004.002c.118.048.246.076.382.076.552 0 1-.447 1-1 0-.417-.256-.772-.617-.923zM80 74c.553 0 1-.447 1-1V1c0-.553-.447-1-1-1-.552 0-1 .447-1 1v72c0 .553.447 1 1 1zM80 86c-.552 0-1 .447-1 1v72c0 .553.447 1 1 1s1-.447 1-1V87c0-.553-.447-1-1-1zM77.36 85.47c-.417 0-.772.254-.923.616l-27.564 66.53.002.002c-.05.117-.077.246-.077.382 0 .553.446 1 1 1 .416 0 .772-.255.922-.618h.002L78.28 86.86v-.004l.003-.005c.048-.117.076-.246.076-.382 0-.552-.448-1-1-1zM82.708 74.547c.417 0 .772-.255.923-.618h.003l27.56-66.547h-.004c.048-.12.076-.247.076-.383 0-.553-.447-1-1-1-.416 0-.772.255-.922.618h-.002l-27.56 66.546h.004c-.05.12-.077.247-.077.383-.002.553.445 1 .998 1zM74 80c0-.552-.446-1-1-1H1c-.552 0-1 .447-1 1 0 .553.447 1 1 1h72c.554 0 1-.446 1-1z"/></g></svg>
          <span>教程</span>
        </a>
      </div>
    
      <div class="panel-item active"">
        <a class="" href="http://guide.meteor.com"  >
          <svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#BDA671" d="M80 1.988c43.01 0 78 34.99 78 78s-34.99 78-78 78-78-34.99-78-78 34.99-78 78-78m0-2c-44.183 0-80 35.817-80 80s35.817 80 80 80 80-35.817 80-80-35.817-80-80-80z"/><path fill="#BDA671" d="M126.454 33.545l-37.93 54.98-54.98 37.93 37.93-54.98 54.98-37.93m0-2c-.395 0-.79.116-1.135.354L70.336 69.826c-.2.138-.373.312-.51.51l-37.93 54.98c-.548.796-.45 1.868.232 2.55.386.388.898.587 1.414.587.395 0 .79-.116 1.135-.354l54.98-37.93c.2-.137.373-.31.51-.51l37.93-54.98c.548-.795.45-1.867-.232-2.55-.387-.386-.9-.585-1.414-.585z"/><circle fill="#BDA671" cx="79.999" cy="79.999" r="2.999"/><path fill="#BDA671" d="M135.477 50.182c-.02-.036-.04-.05-.06-.045-.173-.303-.485-.516-.858-.516-.553 0-1 .448-1 1 0 .21.078.394.188.554l-.02.007C138.358 59.766 141 69.57 141 79.99c0 33.636-27.364 61-61 61-10.42 0-20.232-2.634-28.82-7.26l-.005.02c-.144-.08-.3-.14-.478-.14-.552 0-1 .448-1 1 0 .336.176.618.43.8-.016.012-.034.025-.03.027 8.896 4.81 19.078 7.552 29.904 7.552 34.795 0 63-28.206 63-63 0-10.79-2.735-20.93-7.523-29.805zM109.65 24.47c-.002-.02.004-.04-.025-.056-8.83-4.727-18.908-7.426-29.625-7.426-34.794 0-63 28.206-63 63 0 10.79 2.73 20.935 7.514 29.81.005.01.012.004.018.01.17.312.488.532.87.532.552 0 1-.447 1-1 0-.197-.073-.37-.17-.525l.04-.002C21.642 100.223 19 90.41 19 79.988c0-33.636 27.364-61 61-61 10.4 0 20.185 2.634 28.757 7.248.02.01.036.02.055.028.116.047.24.075.37.075.554 0 1-.448 1-1 .002-.382-.22-.7-.533-.87z"/></svg>
          <span>指南</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="http://docs.meteor.com"  >
          <svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#DE4F4F" d="M35.6 30.167v5.375h89.8c.553 0 1 .447 1 1v7.375c0 .553-.447 1-1 1H35.6v5.375h89.8c.553 0 1 .447 1 1v7.375c0 .553-.447 1-1 1H35.6v5.375h89.8c.553 0 1 .447 1 1v7.375c0 .55-.447 1-1 1H35.6v5.375h89.8c.553 0 1 .447 1 1v7.375c0 .55-.447 1-1 1H35.6v5.375h89.8c.553 0 1 .447 1 1v7.375c0 .55-.447 1-1 1H35.6v5.375h89.8c.553 0 1 .447 1 1v7.375c0 .55-.447 1-1 1H35.6v5.375h89.8c.553 0 1 .447 1 1v7.375c0 .55-.447 1-1 1H35.6v5.375H80c.552 0 1 .447 1 1v10.873c1.162.413 2 1.51 2 2.816 0 1.657-1.343 3-3 3s-3-1.343-3-3c0-1.305.837-2.402 2-2.815v-9.873H34.6c-.552 0-1-.45-1-1v-7.375c0-.553.448-1 1-1h89.8v-5.375H34.6c-.552 0-1-.45-1-1v-7.375c0-.553.448-1 1-1h89.8v-5.375H34.6c-.552 0-1-.45-1-1v-7.375c0-.553.448-1 1-1h89.8v-5.375H34.6c-.552 0-1-.45-1-1v-7.375c0-.553.448-1 1-1h89.8v-5.375H34.6c-.552 0-1-.45-1-1v-7.375c0-.553.448-1 1-1h89.8v-5.375H34.6c-.552 0-1-.447-1-1v-7.375c0-.553.448-1 1-1h89.8v-5.375H34.6c-.552 0-1-.447-1-1v-7.375c0-.553.448-1 1-1h89.8v-5.375H34.6c-.552 0-1-.447-1-1v-7.375c0-.553.448-1 1-1h89.8v-5.375H34.6c-.552 0-1-.447-1-1s.448-1 1-1h90.8c.553 0 1 .447 1 1v7.375c0 .553-.447 1-1 1H35.6zM138 6.564H22c-1.104 0-2 .896-2 2v144c0 1.104.896 2 2 2h48.995c.258 0 .516-.097.712-.293.39-.39.39-1.022 0-1.413-.195-.195-.45-.293-.707-.293H22v-144h116v144H89.006c-.258 0-.517.097-.713.293-.39.39-.39 1.023 0 1.414.196.198.455.294.713.293H138c1.104 0 2-.895 2-2v-144c0-1.103-.896-2-2-2z"/></svg>
          <span>API 文档</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="https://forums.meteor.com/" target=_new >
          <svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><path fill="#333" d="M60.025 17.72c7.396 0 14.914 1.424 22.172 4.43 29.594 12.258 43.648 46.188 31.39 75.782-9.25 22.334-30.843 35.812-53.6 35.812-4.694 0-9.437-.574-14.132-1.76L32.44 142.277 30.23 125.51C5.908 111.003-4.74 80.48 6.418 53.538 15.67 31.204 37.266 17.72 60.025 17.72m0-2c-24.363 0-46.13 14.545-55.455 37.053-5.547 13.394-6.06 28.33-1.447 42.052 4.465 13.276 13.414 24.57 25.252 31.896l2.082 15.82c.092.708.557 1.31 1.217 1.585.246.104.506.152.766.152.434 0 .86-.142 1.217-.412l12.656-9.713c4.482 1.055 9.076 1.59 13.674 1.59 24.36 0 46.126-14.543 55.447-37.047 6.135-14.807 6.135-31.115.002-45.922C109.3 37.966 97.77 26.433 82.963 20.3c-7.34-3.04-15.06-4.58-22.938-4.58zM92.69 133.9c.165-.443.614-.683 1.064-.623l.004-.024c5.18.558 10.343.396 15.365-.414v2.034c-5.13.796-10.4.942-15.69.356l.002-.02c-.052-.01-.105-.006-.158-.023-.517-.193-.78-.768-.586-1.287z"/><path fill="#333" d="M100.877 133.604c4.41-.065 8.86-.633 13.268-1.746l13.416 10.295 2.208-16.77c24.324-14.505 34.976-45.03 23.814-71.97-9.248-22.33-30.832-35.81-53.584-35.82v.02c-2.072-.002-4.154.096-6.238.32l-.004-.024c-.45.058-.9-.18-1.064-.625-.194-.518.068-1.093.586-1.286.054-.02.107-.015.158-.026l-.002-.02c2.19-.24 4.377-.348 6.553-.35v-.01c24.36.004 46.12 14.545 55.443 37.054 5.55 13.393 6.062 28.327 1.447 42.05-4.465 13.28-13.414 24.57-25.252 31.897l-2.082 15.818c-.092.71-.557 1.312-1.217 1.586-.246.103-.506.15-.766.15-.435 0-.86-.14-1.218-.412l-12.655-9.713c-4.2.988-8.502 1.502-12.812 1.564l.002-1.986z"/><circle fill="#333" cx="60.019" cy="77" r="3.001"/><circle fill="#333" cx="76.018" cy="77" r="3"/><circle fill="#333" cx="44.019" cy="77" r="3.001"/></svg>

          <span>论坛</span>
        </a>
      </div>
    
  </div>

  <div class="sidebar-content">
    <div class="topcap">
      <span class="title-sidebar">Meteor 指南 中译本</span>
      
        <span class="select version-sidebar nochrome">
          <select class="version-select">
            
              <option value="v1.3">1.3</option>
            
              <option value="v1.2">1.2</option>
            
          </select>
        </span>
      
    </div>

    
    <div class="wrapper-search">
      <div class="input-symbol small round">
        <input type="text" placeholder="Search 官方指南" id="desktop-search-input" />
        <span class="icon-search"></span>
      </div>
      <div class="wrapper-desktop-search-results"></div>
    </div>

    

    <ul class="toc">
      
        <li>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="index.html" class="sidebar-link ">
                  <span>介绍</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="code-style.html" class="sidebar-link ">
                  <span>编码风格</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="structure.html" class="sidebar-link ">
                  <span>Application Structure</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="1.3-migration.html" class="sidebar-link ">
                  <span>Migrating to Meteor 1.3</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">数据</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="collections.html" class="sidebar-link ">
                  <span>数据集与数据结构</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="data-loading.html" class="sidebar-link ">
                  <span>Publications and Data Loading</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="methods.html" class="sidebar-link ">
                  <span>Methods</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="accounts.html" class="sidebar-link ">
                  <span>Users and Accounts</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="testing.html" class="sidebar-link ">
                  <span>Testing</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">视图</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="routing.html" class="sidebar-link ">
                  <span>URL 和路由</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="ui-ux.html" class="sidebar-link ">
                  <span>User Interfaces</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="blaze.html" class="sidebar-link ">
                  <span>Blaze</span>
                </a>
              </li>
            
              
              <li class="item-toc  current">
                <a href="" class="sidebar-link  current">
                  <span>React</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="angular.html" class="sidebar-link ">
                  <span>Angular</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">构建</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="atmosphere-vs-npm.html" class="sidebar-link ">
                  <span>Atmosphere vs. npm</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="using-atmosphere-packages.html" class="sidebar-link ">
                  <span>Using Atmosphere Packages</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="writing-atmosphere-packages.html" class="sidebar-link ">
                  <span>Writing Atmosphere Packages</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="using-npm-packages.html" class="sidebar-link ">
                  <span>Using npm Packages</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="writing-npm-packages.html" class="sidebar-link ">
                  <span>Writing npm Packages</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="mobile.html" class="sidebar-link ">
                  <span>Mobile</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="build-tool.html" class="sidebar-link ">
                  <span>Build System</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">生产环境</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="security.html" class="sidebar-link ">
                  <span>Security</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="deployment.html" class="sidebar-link ">
                  <span>Deployment and Monitoring</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">有关本指南</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="CONTRIBUTING.html" class="sidebar-link ">
                  <span>Contribution Guidelines</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="CHANGELOG.html" class="sidebar-link ">
                  <span>Changelog</span>
                </a>
              </li>
            
          </ul>
        </li>
      
    </ul>
  </div>
</div>


<div class="nav dark">
  <div class="nav-group">
    <div class="nav-item">
      <span class="js-sidebar-toggle">
        <span class="icon-menu"></span>
      </span>
    </div>
  </div>

  <div class="center-wrapper">
    <img src="../images/logo-coralspace.svg" alt="Meteor 指南 中译本"/>
    <div>官方指南</div>
  </div>

  
  <div class="nav-group right">
    <div class="nav-item">
      <span class="js-search-toggle">
        <span class="icon-search"></span>
      </span>
    </div>
  </div>

  <div class="nav-search">
    <div class="input-symbol">
      <input type="text" placeholder="Search 官方指南" id="mobile-search-input"/>
      <span class="icon-search"></span>
    </div>

    <div class="nav-group right">
      <div class="nav-item">
        <span class="js-search-toggle">
          <span class="icon-close"></span>
        </span>
      </div>
    </div>
    
    <div class="wrapper-mobile-search-results"></div>
  </div>
  
</div>

<div class="content">
  <div class="content-wrapper">
    <div class="header-content">
      <h1 class="title-page">React</h1>
      
        <div class="subtitle-page">如何在 Meteor 中使用 React（Facebook 的前端渲染库）</div>
      

      <div class="page-actions">
        <div class="actions-group">
          <a class="btn primary small round lowercase" href="https://github.com/ourmeteor/guide-zh/tree/master/content/react.md" target="_blank"><span class="icon-github"></span> <span>Edit on GitHub</span></a>
          
            <a class="btn tertiary small round lowercase" href="https://forums.meteor.com/t/20192"><span class="icon-comment"></span> <span>Discuss</span></a>
          
        </div>
      </div>
    </div>

    <div class="document-formatting">
      <p>读完这篇文章，你将学到：</p>
<ol>
<li>什么是 React，为什么你会考虑在 Meteor 中使用 React。</li>
<li>如何在你的 Meteor 应用中安装 React 并正确地使用它。</li>
<li>如何将 React 与 Meteor 的实时数据层进行整合。</li>
<li>如何在一个 React-Meteor 应用中进行路由（页面跳转）。</li>
</ol>
<h2 id="introduction">介绍</h2>

<p><a href="https://facebook.github.io/react/" target="_blank" rel="external">React</a> 是由 Facebook 团队开发并维护，用于构建响应式用户界面的 JavaScript 库。React 是 Meteor 所支持的三种渲染库之一，其它两者分别是 <a href="blaze.html">Blaze</a> 和 <a href="angular.html">Angular</a>。若有兴趣，你可以在这里查看他们<a href="ui-ux.html#view-layers">三者的比较</a>。</p>
<p>React 有着一个活跃并且仍在不断壮大的生态系统，并且，搭配着各种不同的框架，React 已经被广泛地应用于生产实践中。</p>
<p>想了解更多关于 React 的知识并且快速上手，请参考 <a href="https://facebook.github.io/react/docs/getting-started.html" target="_blank" rel="external">React documentation</a>。<a href="https://facebook.github.io/react/docs/thinking-in-react.html" target="_blank" rel="external">thinking in React</a> 这篇文章更是很好地阐明了 React 背后的哲学思想。</p>
<p>想要在 Meteor 中上快速上手使用 React，你可以参考 <a href="https://www.meteor.com/tutorials/react/creating-an-app" target="_blank" rel="external">React tutorial</a>。若想要进一步了解如何使用 React 开发更加完整的 Meteor 应用，请参考  <a href="https://github.com/meteor/todos/tree/react" target="_blank" rel="external">Todos 应用示例</a>。这篇文章会在一些地方引用这个示例的部分代码。</p>
<h3 id="using-with-meteor">React 的安装与使用</h3>

<p>在 Meteor 1.3 中安装 React，只需将它添加到 npm 依赖：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save react react-dom</span><br></pre></td></tr></table></figure>
<p>这将会在你的项目中安装 <code>react</code> 并允许你在项目文件中通过 <code>import React from &#39;react&#39;</code> 来使用它。绝大部分 React 代码是用 <a href="https://facebook.github.io/react/docs/jsx-in-depth.html" target="_blank" rel="external">JSX</a> 格式来编写的，不过你不用担心编译问题，如果你在项目中添加了 <code>ecmascript</code> 这个 Atmosphere 包，那么你可以<a href="http://guide.meteor.com/build-tool.html#react-jsx" target="_blank" rel="external">在 Meteor 项目中直接编写并使用JSX文件</a>，而这个包，则是所有 Meteor 应用默认安装的。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>你可以使用 <code>react-dom</code> 包在 DOM 中渲染一个组件：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Meteor &#125; <span class="keyword">from</span> <span class="string">'meteor/meteor'</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> HelloWorld <span class="keyword">from</span> <span class="string">'./HelloWorld.js'</span>;</span><br><span class="line"></span><br><span class="line">Meteor.startup(() =&gt; &#123;</span><br><span class="line">  render(<span class="xml"><span class="tag">&lt;<span class="name">HelloWorld</span> /&gt;</span>, document.getElementById('app'));</span><br><span class="line">&#125;);</span></span><br></pre></td></tr></table></figure>
<p>当然，为了使上述代码生效，你需要在你的 HTML 文件的 body 中的某一位置添加 <code>&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;</code>。</p>
<p>每一个新创建的 Meteor 应用都自带 Meteor 的默认模板系统 - Blaze。如果你不打算在项目中<a href="#using-with-blaze">同时使用 React 和 Blaze</a>，你可以通过以下命令从你的项目中删除 Blaze：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">meteor remove blaze-html-templates</span><br><span class="line">meteor add static-html</span><br></pre></td></tr></table></figure>
<h3 id="using-third-party-npm-packages">使用第三方 npm 包</h3>

<p>如果你想使用在 npm 上发布的第三方 React 组件（比如你在 <a href="http://react-components.com" target="_blank" rel="external">React Components site</a> 上找到的组件），你可以通过 <code>npm install --save</code> 来安装它们，并在应用中通过 <code>import</code> 来导入他们。</p>
<p>例如，为了使用超棒的 React 包 <a href="http://griddlegriddle.github.io/Griddle/" target="_blank" rel="external">Griddle</a> 来制作表格，你可以运行如下命令：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save griddle-react</span><br></pre></td></tr></table></figure>
<p>然后，你可以像使用其他 <a href="using-packages.html#npm">npm 包</a>一样，在应用中导入组件：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Griddle <span class="keyword">from</span> <span class="string">'griddle-react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">MyGriddler</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">Griddle</span> <span class="attr">....</span>/&gt;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span></span><br></pre></td></tr></table></figure>
<p>如果你想编写一个 Atmosphere 包来封装一个组件，你需要做<a href="#atmosphere-packages">更多工作</a>。</p>
<p><span id="using-with-blaze"><!-- don't break old links --></span></p>
<h3 id="react-in-blaze">在 Blaze 中使用 React </h3>

<p>有时候，你可能会需要在 <a href="#blaze.html">Blaze</a> 中使用 React，例如，将一个使用 Blaze 构建的大型应用，逐步过渡到 React 上来。这时，你可以使用 <a href="https://atmospherejs.com/meteor/react-template-helper" target="_blank" rel="external"><code>react-template-helper</code></a> 组件，它将帮助你在一个 Blaze 模板中渲染一个 React 组件。首先，运行 <code>meteor add react-template-helper</code>，然后，在你的模板中使用 <code>React</code> helper：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">name</span>=<span class="string">"userDisplay"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello, &#123;&#123;username&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;&gt; React component=UserAvatar userId=_id&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>你需要通过一个 helper 来传递一个 React 组件类：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Template &#125; <span class="keyword">from</span> <span class="string">'meteor/templating'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./userDisplay.html'</span>;</span><br><span class="line"><span class="keyword">import</span> UserAvatar <span class="keyword">from</span> <span class="string">'./UserAvatar.js'</span>;</span><br><span class="line"></span><br><span class="line">Template.userDisplay.helpers(&#123;</span><br><span class="line">  UserAvatar() &#123;</span><br><span class="line">    <span class="keyword">return</span> UserAvatar;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><code>component</code> 这个参数的值正是需要被渲染的 React 组件，它应该通过一个 helper 进行传入。</p>
<p>其他所有的参数都将各自作为一个 React 组件的 prop 传入这个组件。</p>
<p>请注意：</p>
<ul>
<li><p>React 组件必须是这个包裹元素的唯一内容。 由于 React 的一些限制（参考 facebook/react <a href="https://github.com/facebook/react/issues/1970" target="_blank" rel="external">#1970</a>, <a href="https://github.com/facebook/react/issues/2484" target="_blank" rel="external">#2484</a>），一个 React 组件必须是渲染它的父节点的唯一子节点，也就是说，它不能有其他兄弟节点。</p>
</li>
<li><p>这也意味着，一个 React 组件不能是一个 Blaze 模板的唯一内容，因为我们无法预知这个模板将会在哪里被使用。</p>
</li>
</ul>
<h4 id="passing-callbacks-from-blaze">向一个 React 组件传递回调函数</h4>

<p>如果你使用这个 helper 引入了一个 React 组件，为了向它传递一个回调函数，你只需要创建一个<a href="http://guide.meteor.com/blaze.html#pass-callbacks" target="_blank" rel="external">返回一个函数的模板 helper</a>，并将它作为一个 prop 传递给 React 组件，例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Template.userDisplay.helpers(&#123;</span><br><span class="line">  onClick() &#123;</span><br><span class="line">    <span class="keyword">const</span> instance = Template.instance();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从这个 helper 中返回一个函数</span></span><br><span class="line">    <span class="comment">// 注意，instance 变量处在一个闭包中</span></span><br><span class="line">    <span class="keyword">return</span> () =&gt; &#123;</span><br><span class="line">      instance.hasBeenClicked.set(<span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在 Blaze 中使用它：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">name</span>=<span class="string">"userDisplay"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    &#123;&#123;&gt; React component=UserAvatar userId=_id onClick=onClick&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="blaze-in-react">在 React 中使用 Blaze</h3>

<p>正如我们可以在 Blaze 模板中使用 React 组件一样，我们也可以在 React 组件中使用 Blaze 模板。类似地，这种特性对于从 React 逐步过渡到 Blaze 的策略非常有用，然而更棒的是，它使得我们能够在 React 项目中继续使用当初为 Blaze 构建的海量的 Atmosphere 包，就连核心包 <code>accounts-ui</code> 也不例外。</p>
<p>一个简单的方式是使用 <a href="https://atmospherejs.com/gadicc/blaze-react-component" target="_blank" rel="external"><code>gadicc:blaze-react-component</code></a> 包。首先，运行 <code>meteor add gadicc:blaze-react-component</code>，然后，按如下方式在你的组件中导入并使用它：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Blaze <span class="keyword">from</span> <span class="string">'meteor/gadicc:blaze-react-component'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App = () =&gt; (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Blaze</span> <span class="attr">template</span>=<span class="string">"itemsList"</span> <span class="attr">items</span>=<span class="string">&#123;items&#125;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">);</span></span><br></pre></td></tr></table></figure>
<p><code>&lt;Blaze template=&quot;itemsList&quot; items={items} /&gt;</code> 这一行同你在 Blaze 模板中写的 <code>{{> itemsList items=items}}</code> 是一个意思。如需更多信息，请参考这个包的<a href="https://github.com/gadicc/meteor-blaze-react-component" target="_blank" rel="external">项目页</a>。</p>
<h2 id="data">使用 Meteor 的数据系统</h2>

<p>React 是一个前端渲染库，因此，它并不关心数据是如何流入及流出组件的。另一方面，Meteor 对于数据的处理方式非常执着。Meteor 应用通过 <a href="data-loading.html">publications</a> 和 <a href="methods.html">methods</a> 来实际运作，而它们分别被用于订阅和修改应用数据。</p>
<p>为了集成这两大系统，我们开发了 <a href="https://atmospherejs.com/meteor/react-meteor-data" target="_blank" rel="external"><code>react-meteor-data</code></a> 包，利用 Meteor 的响应式系统 <a href="https://www.meteor.com/tracker" target="_blank" rel="external">Tracker</a>，使得 React 组件能够响应数据的改变。</p>
<h3 id="using-createContainer">使用 <code>createContainer</code></h3>

<p>一旦你运行了 <code>meteor add react-meteor-data</code>，你就可以导入 <code>createContainer</code> 函数来创建 <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0#.by86emv9b" target="_blank" rel="external">container 组件</a>，并用它向表现型组件 (presentational component) 提供其所需的数据。</p>
<blockquote>
<p>译者注：presentational 有表现、展现的意思，表现型组件 (presentational component) 即只负责表现样式的组件，它们不关心需要渲染的数据从哪里来。而相对应地，container 组件则只关心如何获取数据并传递给表现型组件。</p>
<p>提一下，「container 组件」 和 「表现型组件」 分别类似于我们在一种设计模式中提到的 「智能组件」 和 「可复用组件」，如果你想了解更多关于这种思想和 Meteor 之间的关系，请参考这篇文章 <a href="http://guide.meteor.com/ui-ux.html#components" target="_blank" rel="external">UI/UX article</a>。</p>
</blockquote>
<p>例如，在 Todos 示例应用中，我们有一个 <code>ListPage</code> 组件，它负责渲染一个 list 的基本信息以及这个 list 中的所有 tasks。为了做到这些，它需要 <a href="data-loading.html#subscriptions">订阅</a> <code>todos.inList</code> 这个publication，检查这个subscription是否就绪，然后从 <code>Todos</code> 数据集中查询数据。</p>
<p>它还需要实时响应相关操作所带来的数据变化（例如，因为另一个用户的某种操作而导致一个 todo 发生改变）。所有这些数据加载的复杂性都是要求 container-presentational 组件分离的典型用例，而 <code>createContainer()</code> 函数则使得这种分离变得非常容易。</p>
<p>我们先简单地将 <code>ListPage</code> 组件定义为一个 presentational 组件，它期望需要的数据以 React <code>props</code> 的形式传入：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ListPage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ListPage.propTypes = &#123;</span><br><span class="line">  list: React.PropTypes.object,</span><br><span class="line">  todos: React.PropTypes.array,</span><br><span class="line">  loading: React.PropTypes.bool,</span><br><span class="line">  listExists: React.PropTypes.bool,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>然后，我们创建一个名为 <code>ListContainer</code> 的 container 组件来包裹 <code>ListPage</code> 并向它提供数据：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Meteor &#125; <span class="keyword">from</span> <span class="string">'meteor/meteor'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Lists &#125; <span class="keyword">from</span> <span class="string">'../../api/lists/lists.js'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createContainer &#125; <span class="keyword">from</span> <span class="string">'meteor/react-meteor-data'</span>;</span><br><span class="line"><span class="keyword">import</span> ListPage <span class="keyword">from</span> <span class="string">'../pages/ListPage.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ListContainer = createContainer((&#123; params &#125;) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = params;</span><br><span class="line">  <span class="keyword">const</span> todosHandle = Meteor.subscribe(<span class="string">'todos.inList'</span>, id);</span><br><span class="line">  <span class="keyword">const</span> loading = !todosHandle.ready();</span><br><span class="line">  <span class="keyword">const</span> list = Lists.findOne(id);</span><br><span class="line">  <span class="keyword">const</span> listExists = !loading &amp;&amp; !!list;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    loading,</span><br><span class="line">    list,</span><br><span class="line">    listExists,</span><br><span class="line">    todos: listExists ? list.todos().fetch() : [],</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, ListPage);</span><br></pre></td></tr></table></figure>
<p>一旦在函数中访问过的<a href="https://atmospherejs.com/meteor/tracker" target="_blank" rel="external">响应式数据源</a>发生任何变化，这个由 <code>createContainer()</code> 创建的 container 组件就会相应地重新渲染它所包裹的组件。</p>
<p>虽然，这个 <code>ListContainer</code> 的设计使用场景是将其放在 React Router 之中并根据路由自动传入参数，不过，如果你想手动实例化这个 container 组件，你只需要将参数作为 props 传入即可：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ListContainer params=&#123;&#123;id: <span class="string">'7'</span>&#125;&#125;/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="preventing-rerenders">防止重新渲染</h3>

<p>有时候，一些数据变化会导致数据的重新运算，但是你很清楚这些变化不会影响到你的UI。虽然通常来说，React 在防止无用的重新渲染方面做得足够有效，但如果你确实需要进行更精确的控制，上述模式让你可以很容易地在表现型组件上使用 React 的 <a href="https://facebook.github.io/react/docs/component-specs.html#updating-shouldcomponentupdate" target="_blank" rel="external"><code>shouldComponentUpdate</code></a> 函数来避免重新渲染。</p>
<h2 id="routing">路由</h2>

<p>在 Meteor-React 应用的路由方面，这里有两个主流选项。无论选择哪一个，我们都建议你在开发应用前，先查阅我们的 <a href="routing.html">「路由」章节</a> 来了解一些关于 Meteor 路由的通用原则。</p>
<ul>
<li><p><a href="https://atmospherejs.com/kadira/flow-router" target="_blank" rel="external"><code>kadira:flow-router</code></a> 是一个面向 Meteor 的路由器。它可以支持 React 和 Blaze。更多信息可参考 <a href="routing.html">「路由」章节</a>。</p>
</li>
<li><p><a href="https://www.npmjs.com/package/react-router" target="_blank" rel="external"><code>react-router</code></a> 是一个面向 React 的路由器，它在 React 社区中非常流行，你也能很方便地在 Meteor 应用中使用它。</p>
</li>
</ul>
<h3 id="using-flow-router">Flow Router</h3>

<p>Flow Router + React 的组合使用起来与 Flow Router + Blaze 的组合非常类似。唯一的区别是，在你的路由动作中，你需要使用 <a href="https://www.npmjs.com/package/react-mounter" target="_blank" rel="external"><code>react-mounter</code></a> 包来挂载组件和布局。当你 <code>npm install --save react-mounter</code> 之后，便可以：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; FlowRouter &#125; <span class="keyword">from</span> <span class="string">'meteor/kadira:flow-router'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; mount &#125; <span class="keyword">from</span> <span class="string">'react-mounter'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> AppContainer <span class="keyword">from</span> <span class="string">'../../ui/containers/AppContainer.js'</span>;</span><br><span class="line"><span class="keyword">import</span> ListContainer <span class="keyword">from</span> <span class="string">'../../ui/containers/ListContainer.js'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FlowRouter.route(<span class="string">'/lists/:_id'</span>, &#123;</span><br><span class="line">  name: <span class="string">'Lists.show'</span>,</span><br><span class="line">  action() &#123;</span><br><span class="line">    mount(AppContainer, &#123;</span><br><span class="line">      main: <span class="xml"><span class="tag">&lt;<span class="name">ListContainer</span>/&gt;</span></span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>注意，<code>react-mounter</code> 会将布局组件挂载到 <code>#react-root</code> 这个DOM节点下。你可以通过 <code>withOptions()</code> 函数来更改这个设定。</p>
<p>在下面这个例子中，你的 <code>App</code> 组件会通过 <code>main</code> prop 收到一个实例化后的 React 组件并渲染它：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> App = (props) =&gt; (</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span> <span class="attr">id</span>=<span class="string">"menu"</span>&gt;</span><span class="tag">&lt;<span class="name">..</span>&gt;</span><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">    &#123;props.main&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> AppContainer = createContainer(props =&gt; &#123;</span><br><span class="line">  <span class="comment">// 这里的 props 中会有一项叫做 `main`，它是由 router 传入的</span></span><br><span class="line">  <span class="comment">// 我们返回的所有东西都会被*添加*到 props 中</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    user: Meteor.user(),</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, App);</span><br></pre></td></tr></table></figure>
<h3 id="using-react-router">React Router</h3>

<p>使用 React Router 也是非常直观的。一旦你 <code>npm install --save react-router</code> 之后，你就可以像在其他 React Router 驱动 React 应用中一样，简单地导出一系列嵌套路由：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Router, Route, browserHistory &#125; <span class="keyword">from</span> <span class="string">'react-router'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// route components</span></span><br><span class="line"><span class="keyword">import</span> AppContainer <span class="keyword">from</span> <span class="string">'../../ui/containers/AppContainer.js'</span>;</span><br><span class="line"><span class="keyword">import</span> ListContainer <span class="keyword">from</span> <span class="string">'../../ui/containers/ListContainer.js'</span>;</span><br><span class="line"><span class="keyword">import</span> AuthPageSignIn <span class="keyword">from</span> <span class="string">'../../ui/pages/AuthPageSignIn.js'</span>;</span><br><span class="line"><span class="keyword">import</span> AuthPageJoin <span class="keyword">from</span> <span class="string">'../../ui/pages/AuthPageJoin.js'</span>;</span><br><span class="line"><span class="keyword">import</span> NotFoundPage <span class="keyword">from</span> <span class="string">'../../ui/pages/NotFoundPage.js'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> renderRoutes = () =&gt; (</span><br><span class="line">  &lt;Router history=&#123;browserHistory&#125;&gt;</span><br><span class="line">    &lt;Route path="/" component=&#123;AppContainer&#125;&gt;</span><br><span class="line">      &lt;Route path="lists/:id" component=&#123;ListContainer&#125;/&gt;</span><br><span class="line">      &lt;Route path="signin" component=&#123;AuthPageSignIn&#125;/&gt;</span><br><span class="line">      &lt;Route path="join" component=&#123;AuthPageJoin&#125;/&gt;</span><br><span class="line">      &lt;Route path="*" component=&#123;NotFoundPage&#125;/&gt;</span><br><span class="line">    &lt;/Route&gt;</span><br><span class="line">  &lt;/Router&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>使用 React Router，你需要在 startup 函数中显式地渲染导出的路由。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Meteor &#125; <span class="keyword">from</span> <span class="string">'meteor/meteor'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; renderRoutes &#125; <span class="keyword">from</span> <span class="string">'../imports/startup/client/routes.js'</span>;</span><br><span class="line"></span><br><span class="line">Meteor.startup(() =&gt; &#123;</span><br><span class="line">  render(renderRoutes(), <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>当你在 Meteor 应用中使用 React Router 时，你可以像使用 Flow Router 一样大致遵守<a href="routing.html">简单的规则</a>即可。但是，你也应当适当参考 React Router <a href="https://github.com/reactjs/react-router/blob/latest/docs/Introduction.md" target="_blank" rel="external">文档</a>所强调的风格、约定与惯例。</p>
<p>其中有一些应当注意的不同点，例如：</p>
<ul>
<li>React Router 鼓励你在路由定义中耦合你的URL设计与布局层次。而 Flow Router 则更加灵活，虽然这样可能会导致更多的样板代码。</li>
<li>React Router 拥抱 React 独有的特性，例如将 router 实例通过 React <a href="https://facebook.github.io/react/docs/context.html" target="_blank" rel="external">context</a> 进行传递。虽然，Flow Router 并没有默认这样做，但你也同样可以显式地将你的 Flow Router 实例作为 context 进行传递（事实上，这很可能正是最佳实践）。</li>
</ul>
<h2 id="meteor-and-react">Meteor 和 React</h2>

<h3 id="atmosphere-packages">在 Atmosphere 包中使用 React</h3>

<p>如果你在编写一个 Atmosphere 包并且需要依赖 React 或一个依赖 React 的 npm 包，你不能使用 <code>Npm.depends()</code> 和 <code>Npm.require()</code>，因为这样会导致你的应用安装 <em>2</em> 个 React 副本（除此之外，<code>Npm.require()</code> 只能在服务端使用）。</p>
<p>正确的做法是，你应当要求你的用户在应用中自行安装正确的 npm 包。这就能保证客户端中仅有一个 React 副本，因此也就不存在版本冲突问题。</p>
<p>为了检查用户是否已经安装正确版本的 npm 包，你可以使用 <a href="https://atmospherejs.com/tmeasday/check-npm-versions" target="_blank" rel="external"><code>tmeasday:check-npm-versions</code></a> 包，以在运行时检查所有依赖的版本。</p>

    </div>
  </div>

  <div class="pagination">
    <div class="content-wrapper">
      
      
        <a class="link primary prev"
          href="mobile.html">
          <span class="icon-arrow-left-alt"></span>
          <span class="subtitle-pagination">Previous</span>
          Mobile
        </a>
      
      
        <a class="link primary next"
          href="routing.html">
          <span class="subtitle-pagination">Next</span>
          URL 和路由
          <span class="icon-arrow-right-alt"></span>
        </a>
      
    </div>
  </div>

  <div class="github">
    <a class="link tertiary " href="https://github.com/ourmeteor/guide-zh/tree/master/content/react.md" target="_blank">
      <span class="icon-github"></span>Edit on GitHub</a>
  </div>

  
    <div class="discourse-comments-wrapper content-wrapper">
      <div id='discourse-comments'></div>
    </div>

    <script type="text/javascript">
      DiscourseEmbed = { discourseUrl: 'http://forums.meteor.com/',
                         topicId: 20192 };

      (function() {
        var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
        d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
      })();
    </script>
  
</div>

    <script src="/script/smooth-scroll.min.js"></script>
    <script src="/script/main.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

    <script>
      // nectar ninja
      (function(){
        var handle = '@meteorjs';
        var a = document.createElement('script');
        var m = document.getElementsByTagName('script')[0];
        a.async = 1;
        a.src = 'https://nectar.ninja/api/v1/' + handle.slice(1);
        m.parentNode.insertBefore(a, m);
      })();

     
      
        // Segment Tracking
        !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
        analytics.load("zQx6cQifkTU79E3L0XAnmrOXP2A5bC6r");
        analytics.page()
        }}();
      

      // search box
      

        ['desktop', 'mobile'].forEach(function(type) {
          var search = docsearch({
            apiKey: 'b123b42bb515f300dc09dc88f7695ec1',
            indexName: 'meteor_guide',
            inputSelector: '#' + type + '-search-input',
            autocompleteOptions: {
              dropdownMenuContainer: '.wrapper-' + type + '-search-results',
              debug: true
            }
          }).autocomplete;

          var sidebar = document.querySelector('.sidebar-content');
          search.on('autocomplete:opened', function() {
            sidebar.classList.add('searching');
          });
          search.on('autocomplete:closed', function() {
            sidebar.classList.remove('searching');
          });
          search.on('autocomplete:updated', function() {
            if (search.val() === '') {
              search.autocomplete.close();
            }
          });
        });
      

      
        var REDIRECTS = {
  "/using-packages.html": "atmosphere-vs-npm.html",
  "/using-packages.html#npm": "using-npm-packages.html",
  "/using-packages.html#client-npm": "using-npm-packages.html#client-npm",
  "/using-packages.html#installing-npm": "using-npm-packages.html#installing-npm",
  "/using-packages.html#using-npm": "using-npm-packages.html#using-npm",
  "/using-packages.html#npm-styles": "using-npm-packages.html#npm-styles",
  "/using-packages.html#npm-shrinkwrap": "using-npm-packages.html#npm-shrinkwrap",
  "/using-packages.html#atmosphere": "using-atmosphere-packages.html",
  "/using-packages.html#atmosphere-searching": "using-atmosphere-packages.html#atmosphere-searching",
  "/using-packages.html#atmosphere-naming": "using-atmosphere-packages.html#atmosphere-naming",
  "/using-packages.html#installing-atmosphere": "using-atmosphere-packages.html#installing-atmosphere",
  "/using-packages.html#using-atmosphere": "using-atmosphere-packages.html#using-atmosphere",
  "/using-packages.html#importing-atmosphere-styles": "using-atmosphere-packages.html#importing-atmosphere-styles",
  "/using-packages.html#peer-npm-dependencies": "using-atmosphere-packages.html#peer-npm-dependencies",
  "/using-packages.html#package-namespacing": "using-atmosphere-packages.html#package-namespacing",
  "/using-packages.html#async-callbacks": "using-npm-packages.html#async-callbacks",
  "/using-packages.html#bind-environment": "using-npm-packages.html#bind-environment",
  "/using-packages.html#wrap-async": "using-npm-packages.html#wrap-async",
  "/using-packages.html#promises": "using-npm-packages.html#promises",
  "/using-packages.html#overriding-packages": "writing-npm-packages.html#overriding-npm-packages",
  "/using-packages.html#npm-overriding": "writing-npm-packages.html#overriding-npm-packages",
  "/using-packages.html#atmosphere-overriding": "writing-atmosphere-packages.html#overriding-atmosphere-packages",
  "/using-packages.html#npm-shrinkpack": "using-npm-packages.html#npm-shrinkpack",
  "/writing-packages.html": "writing-atmosphere-packages.html",
  "/writing-packages.html#npm-vs-atmosphere": "atmosphere-vs-npm.html",
  "/writing-packages.html#creating-npm": "writing-npm-packages.html",
  "/writing-packages.html#including-in-app": "writing-npm-packages.html#including-in-app",
  "/writing-packages.html#publishing-npm": "writing--packages.html#publishing-npm",
  "/writing-packages.html#creating": "writing-atmosphere-packages.html",
  "/writing-packages.html#adding-files": "writing-atmosphere-packages.html#adding-files",
  "/writing-packages.html#adding-javascript": "writing-atmosphere-packages.html#adding-javascript",
  "/writing-packages.html#adding-css": "writing-atmosphere-packages.html#adding-css",
  "/writing-packages.html#adding-style": "writing-atmosphere-packages.html#adding-style",
  "/writing-packages.html#adding-assests": "writing-atmosphere-packages.html#adding-assets",
  "/writing-packages.html#exporting": "writing-atmosphere-packages.html#exporting",
  "/writing-packages.html#dependencies": "writing-atmosphere-packages.html#dependencies",
  "/writing-packages.html#atmosphere-dependencies": "writing-atmosphere--packages.html#atmosphere-dependencies",
  "/writing-packages.html#meteor-version-dependencies": "writing-atmosphere-packages.html#meteor-version-dependencies",
  "/writing-packages.html#version-constraints": "writing-atmosphere-packages.html#version-constraints",
  "/writing-packages.html#npm-dependencies": "writing-atmosphere-packages.html#npm-dependencies",
  "/writing-packages.html#peer-npm-dependencies": "writing-atmosphere-packages.html#peer-npm-dependencies",
  "/writing-packages.html#cordova-plugins": "writing-atmosphere-packages.html#cordova-plugins",
  "/writing-packages.html#testing": "writing-atmosphere-packages.html#testing",
  "/writing-packages.html#testing-with-peer-dependencies": "writing-atmosphere-packages.html#testing-with-peer-dependencies",
  "/writing-packages.html#local-vs-published": "writing-atmosphere-packages.html#local-vs-published",
  "/writing-packages.html#build-plugins": "build-tool.html#build-plugins",
  "/writing-packages.html#types-of-build-plugins": "build-tool.html#types-of-build-plugins",
  "/writing-packages.html#writing-build-plugins": "build-tool.html#writing-build-plugins",
  "/writing-packages.html#caching-build-plugins": "build-tool.html#caching-build-plugins",
  "/testing.html#simple-unit-test": "testing.html#simple-blaze-unit-test"
};

        function redirect() {
          // Support redirects of the form /path#hash
          var locationKey = location.pathname + location.hash;
          if (REDIRECTS[locationKey]) {
            location.replace(location.origin + '/' + REDIRECTS[locationKey]);
          }

          // Support redirects of the form #hash (works for any path)
          var hashKey = location.hash;
          if (REDIRECTS[hashKey]) {
            location.replace(location.origin + '/' + REDIRECTS[hashKey]);
          }
        }

        // Redirect now
        redirect();

        // Redirect on hash change
        window.onhashchange = redirect;
      
    </script>
  </body>
</html>
